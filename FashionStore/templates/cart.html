<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your Cart | Trendy Fashion Hub</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
<header>
  <h1>Trendy Fashion Hub</h1>
  <nav>
    <a href="{{ url_for('index') }}">Home</a>
    <a href="{{ url_for('index') }}#products">Shop</a>
    <a href="{{ url_for('view_cart') }}">Cart üõí</a>
  </nav>
</header>

<main class="cart-container">
  <h2>Your Shopping Cart</h2>

  {% if cart_items %}
  <div class="cart-table">
    <table>
      <thead>
        <tr>
          <th>Item</th><th>Price</th><th>Qty</th><th>Total</th><th></th>
        </tr>
      </thead>
      <tbody>
        {% for item in cart_items %}
        <tr>
          <td class="cart-item">
            <img src="{{ url_for('static', filename=item.image) }}" alt="{{ item.item_name }}">
            <span>{{ item.item_name }}</span>
          </td>
          <td>KSh {{ "{:,.2f}".format(item.unit_price) }}</td>
          <td>
            <form method="POST" action="{{ url_for('update_cart') }}" class="qty-form">
              <input type="hidden" name="item_id" value="{{ item.id }}">
              <input type="number" name="quantity" value="{{ item.quantity }}" min="1" max="{{ item.current_stock }}">
              <button type="submit" class="btn-update">‚úî</button>
            </form>
            {% if 0 < item.current_stock < 5 %}
              <small class="low-stock">Low stock!</small>
            {% endif %}
          </td>
          <td>KSh {{ "{:,.2f}".format(item.total) }}</td>
          <td>
            <form method="POST" action="{{ url_for('update_cart') }}">
              <input type="hidden" name="item_id" value="{{ item.id }}">
              <input type="hidden" name="quantity" value="0">
              <button type="submit" class="btn-remove">‚úñ</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="checkout">
    <p><strong>Total: KSh {{ "{:,.2f}".format(grand_total) }}</strong></p>
    <form method="POST" action="{{ url_for('checkout') }}">
      <button type="submit" class="checkout-btn">Proceed to Checkout</button>
    </form>
  </div>

  {% else %}
    <p class="empty-cart">Your cart is empty üõçÔ∏è</p>
    <p class="empty-cart-link"><a href="{{ url_for('index') }}">Back to Shop</a></p>
  {% endif %}
</main>

<footer>
  <p>&copy; 2025 Trendy Fashion Hub. All rights reserved.</p>
</footer>
</body>
</html>
